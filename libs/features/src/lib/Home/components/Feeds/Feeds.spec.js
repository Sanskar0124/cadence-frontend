import { render, screen } from "@cadence-frontend/test-utils";
import userEvent from "@testing-library/user-event";
import "@testing-library/jest-dom";
import Feeds from "./Feeds";
import { rest } from "msw";
import { setupServer } from "msw/node";
import { ENV } from "@cadence-frontend/environments";

const mails = {
	bounced_mails: [
		{
			activity_id: 62392,
			name: "Email sent to Jolyne Cujoh has bounced.",
			type: "bounced_mail",
			status: "The Email has bounced.",
			comment: null,
			recording: null,
			voicemail: null,
			to_number: null,
			from_number: null,
			incoming: null,
			read: false,
			ringover_call_id: null,
			salesforce_task_id: null,
			message_id: "185e3ab0e6c0d877",
			sent_message_id: null,
			gmail_message_id: null,
			note_id: null,
			cadence_id: 252,
			node_id: 990,
			task_id: null,
			created_at: "2023-01-24T12:05:22.000Z",
			updated_at: "2023-01-24T12:05:22.000Z",
			lead_id: 11940,
			Lead: {
				lead_id: 11940,
				type: "header_form",
				status: "ongoing",
				first_name: "Sri",
				last_name: "Devi",
				full_name: "Jolyne Cujoh",
				email: null,
				email_validity: null,
				linkedin_url: null,
				job_position: "Actress",
				source_site: null,
				duplicate: null,
				first_path: null,
				salesforce: null,
				verified: false,
				score: null,
				first_contact_time: "2023-01-24T12:05:17.000Z",
				avg_time_till_first_call: 0,
				stopped_cadence: false,
				assigned_time: "2023-01-12T08:41:02.000Z",
				salesforce_lead_id: "00Q2w00000PzeQkEAJ",
				salesforce_contact_id: null,
				integration_id: "00Q2w00000PzeQkEAJ",
				integration_type: "salesforce_lead",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
				account_id: 7528,
				ringover_message_conv_id: null,
				integration_status: "Open - Not Contacted",
				created_at: "2023-01-12T08:41:02.000Z",
				updated_at: "2023-01-24T12:05:17.000Z",
				User: {
					profile_picture:
						"https://storage.googleapis.com/apt-cubist-307713.appspot.com/crm/profile-images/49ed6822-df47-4df9-ae2a-737e3a861f7a",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					first_name: "Yuvraj",
					last_name: "Singh",
					email: "email@company.com",
					primary_email: "email@company.com",
					password: "$2b$10$L6NuTUSH9jdZ.6oJyY7bJeLWLF1dIf3K4crp00tBXETq6G0al6kP.",
					role: "super_admin",
					linkedin_url: null,
					primary_phone_number: "+33755523632",
					timezone: "Asia/Kolkata",
					language: "english",
					columns: null,
					smart_action_type: [],
					smart_action: false,
					is_profile_picture_present: true,
					ringover_user_id: "96337",
					salesforce_owner_id: "0052w00000BbsJyAAJ",
					integration_type: "salesforce_owner",
					integration_id: "0052w00000BbsJyAAJ",
					create_agendas_from_custom_task: false,
					calendly_url: "",
					is_call_iframe_fixed: true,
					settings_id: 11,
					is_onboarding_complete: true,
					created_at: "2022-12-22T06:46:42.000Z",
					updated_at: "2023-01-31T05:37:22.000Z",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					department_id: "a2a2d250-7941-459d-ac9c-edf16c696b39",
					sd_id: "40d9cbc2-0203-41e0-b086-414b5509d7cc",
					Company: {
						company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
						name: "Exploration Enterprise",
						url: null,
						linkedin_url: null,
						location: null,
						number_of_licences: 15,
						is_subscription_active: true,
						is_trial_active: false,
						integration_type: "salesforce",
						integration_id: "22824763",
						ringover_team_id: null,
						trial_valid_until: null,
						created_at: "2022-12-22T06:46:41.000Z",
						updated_at: "2023-01-02T10:46:44.000Z",
					},
				},
				LeadToCadences: [
					{
						status: "in_progress",
						Cadences: [
							{
								cadence_id: 30077,
								name: "ReplyAfter1min_Cadence",
								salesforce_cadence_id: "a012w000014c1YDAAY",
								status: "in_progress",
								unix_resume_at: null,
							},
						],
					},
				],
				Account: {
					account_id: 7528,
					name: "Actress",
					url: null,
					linkedin_url: null,
					phone_number: null,
					size: "101-200",
					zipcode: null,
					country: null,
					salesforce_account_id: null,
					integration_id: null,
					integration_type: "salesforce_lead_account",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					integration_status: null,
					created_at: "2023-01-12T08:41:02.000Z",
					updated_at: "2023-01-24T12:04:56.000Z",
				},
				Lead_emails: [
					{
						lem_id: 11794,
						email_id: "eohovhewvewibviuebiuwbviwuve@gmail.com",
						is_primary: true,
						type: "Email",
						lead_id: 11940,
						created_at: "2023-01-12T08:41:02.000Z",
						updated_at: "2023-01-24T12:04:56.000Z",
					},
				],
				Lead_phone_numbers: [
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 23183,
						phone_number: "",
						type: "MobilePhone",
						timezone: null,
						is_primary: false,
						lead_id: 11940,
						created_at: "2023-01-12T08:41:02.000Z",
						updated_at: "2023-01-12T08:41:02.000Z",
					},
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 23182,
						phone_number: "",
						type: "Phone",
						timezone: null,
						is_primary: true,
						lead_id: 11940,
						created_at: "2023-01-12T08:41:02.000Z",
						updated_at: "2023-01-12T08:41:02.000Z",
					},
				],
			},
		},
	],
	viewed_mails: [
		{
			activity_id: 62539,
			name: "Joseph Joestar has viewed the mail",
			type: "viewed_mail",
			status: "The lead has viewed the mail.",
			comment: null,
			recording: null,
			voicemail: null,
			to_number: null,
			from_number: null,
			incoming: true,
			read: true,
			ringover_call_id: null,
			salesforce_task_id: null,
			message_id: "185f9a98a66e629b",
			sent_message_id: null,
			gmail_message_id: null,
			note_id: null,
			cadence_id: 30134,
			node_id: 31032,
			task_id: null,
			created_at: "2023-01-28T19:12:24.000Z",
			updated_at: "2023-02-01T08:10:19.000Z",
			lead_id: 11992,
			Lead: {
				lead_id: 11992,
				type: "header_form",
				status: "new_lead",
				first_name: "Spider",
				last_name: "Man",
				full_name: "Joseph Joestar",
				email: null,
				email_validity: null,
				linkedin_url: null,
				job_position: null,
				source_site: null,
				duplicate: null,
				first_path: null,
				salesforce: null,
				verified: false,
				score: null,
				first_contact_time: null,
				avg_time_till_first_call: 0,
				stopped_cadence: false,
				assigned_time: "2023-01-12T19:00:23.000Z",
				salesforce_lead_id: "00Q2w00000PzQpiEAF",
				salesforce_contact_id: null,
				integration_id: "00Q2w00000PzQpiEAF",
				integration_type: "salesforce_lead",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
				account_id: 7559,
				ringover_message_conv_id: null,
				integration_status: null,
				created_at: "2023-01-12T19:00:23.000Z",
				updated_at: "2023-01-17T09:21:09.000Z",
				User: {
					profile_picture:
						"https://storage.googleapis.com/apt-cubist-307713.appspot.com/crm/profile-images/49ed6822-df47-4df9-ae2a-737e3a861f7a",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					first_name: "Yuvraj",
					last_name: "Singh",
					email: "email@company.com",
					primary_email: "email@company.com",
					password: "$2b$10$L6NuTUSH9jdZ.6oJyY7bJeLWLF1dIf3K4crp00tBXETq6G0al6kP.",
					role: "super_admin",
					linkedin_url: null,
					primary_phone_number: "+33755523632",
					timezone: "Asia/Kolkata",
					language: "english",
					columns: null,
					smart_action_type: [],
					smart_action: false,
					is_profile_picture_present: true,
					ringover_user_id: "96337",
					salesforce_owner_id: "0052w00000BbsJyAAJ",
					integration_type: "salesforce_owner",
					integration_id: "0052w00000BbsJyAAJ",
					create_agendas_from_custom_task: false,
					calendly_url: "",
					is_call_iframe_fixed: true,
					settings_id: 11,
					is_onboarding_complete: true,
					created_at: "2022-12-22T06:46:42.000Z",
					updated_at: "2023-01-31T05:37:22.000Z",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					department_id: "a2a2d250-7941-459d-ac9c-edf16c696b39",
					sd_id: "40d9cbc2-0203-41e0-b086-414b5509d7cc",
					Company: {
						company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
						name: "Exploration Enterprise",
						url: null,
						linkedin_url: null,
						location: null,
						number_of_licences: 15,
						is_subscription_active: true,
						is_trial_active: false,
						integration_type: "salesforce",
						integration_id: "22824763",
						ringover_team_id: null,
						trial_valid_until: null,
						created_at: "2022-12-22T06:46:41.000Z",
						updated_at: "2023-01-02T10:46:44.000Z",
					},
				},
				LeadToCadences: [
					{
						status: "not_started",
						Cadences: [
							{
								cadence_id: 140,
								name: "All Steps cadence (copy)",
								salesforce_cadence_id: "a012w000012lQUQAA2",
								status: "paused",
								unix_resume_at: null,
							},
						],
					},
				],
				Account: {
					account_id: 7559,
					name: "CRM",
					url: "https://website-crm.com2",
					linkedin_url: null,
					phone_number: null,
					size: "",
					zipcode: null,
					country: "",
					salesforce_account_id: null,
					integration_id: null,
					integration_type: "salesforce_lead_account",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					integration_status: null,
					created_at: "2023-01-12T19:00:23.000Z",
					updated_at: "2023-01-25T16:57:21.000Z",
				},
				Lead_emails: [
					{
						lem_id: 11874,
						email_id: "swarup_ranjan_mondal@bjtmail.com",
						is_primary: false,
						type: "Email",
						lead_id: 11992,
						created_at: "2023-01-12T19:00:23.000Z",
						updated_at: "2023-01-17T09:21:09.000Z",
					},
				],
				Lead_phone_numbers: [
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 23274,
						phone_number: "",
						type: "Phone",
						timezone: null,
						is_primary: false,
						lead_id: 11992,
						created_at: "2023-01-12T19:00:23.000Z",
						updated_at: "2023-01-17T09:21:08.000Z",
					},
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 23275,
						phone_number: "",
						type: "MobilePhone",
						timezone: null,
						is_primary: false,
						lead_id: 11992,
						created_at: "2023-01-12T19:00:23.000Z",
						updated_at: "2023-01-17T09:21:08.000Z",
					},
				],
			},
			Email: {
				tracking_image_url:
					"https://cd-dev.ringover-crm.xyz/image/invisibleImage/185f9a98a66e629b",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				lead_id: 11992,
				sent: true,
				et_id: null,
				message_id: "185f9a98a66e629b",
				thread_id: "185f9a98a66e629b",
				status: "opened",
				tracking_status_update_timestamp: "2023-01-28T19:12:24.000Z",
				tracking_image_id: "10864914e",
				cadence_id: 30134,
				node_id: 31032,
				open_count: 0,
				unsubscribed: false,
				is_replied_mail: false,
				created_at: "2023-01-28T18:35:18.000Z",
				updated_at: "2023-01-29T15:31:11.000Z",
			},
		},
	],
	replied_mails: [
		{
			activity_id: 443,
			name: "Reply received from Enrico Pucci",
			type: "reply_to",
			status: "Subject: Re: dwqwwqd",
			comment: null,
			recording: null,
			voicemail: null,
			to_number: null,
			from_number: null,
			incoming: true,
			read: true,
			ringover_call_id: null,
			salesforce_task_id: null,
			message_id: "18553988b0cf9c96",
			sent_message_id: null,
			gmail_message_id: null,
			note_id: null,
			cadence_id: 74,
			node_id: null,
			task_id: null,
			created_at: "2022-12-27T12:39:33.000Z",
			updated_at: "2023-01-16T12:21:22.000Z",
			lead_id: 1,
			Lead: {
				lead_id: 1,
				type: "header_form",
				status: "ongoing",
				first_name: "Nishant",
				last_name: "Choudhary",
				full_name: "Enrico Pucci",
				email: null,
				email_validity: null,
				linkedin_url: null,
				job_position: null,
				source_site: null,
				duplicate: null,
				first_path: null,
				salesforce: null,
				verified: false,
				score: null,
				first_contact_time: "2022-12-23T12:54:06.000Z",
				avg_time_till_first_call: 0,
				stopped_cadence: false,
				assigned_time: "2022-12-22T10:42:10.000Z",
				salesforce_lead_id: "00Q2w00000OEkekEAD",
				salesforce_contact_id: null,
				integration_id: "00Q2w00000OEkekEAD",
				integration_type: "salesforce_lead",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
				account_id: 1,
				ringover_message_conv_id: null,
				integration_status: "Open - Not Contacted",
				created_at: "2022-12-22T10:42:10.000Z",
				updated_at: "2023-01-03T13:52:49.000Z",
				User: {
					profile_picture:
						"https://storage.googleapis.com/apt-cubist-307713.appspot.com/crm/profile-images/49ed6822-df47-4df9-ae2a-737e3a861f7a",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					first_name: "Yuvraj",
					last_name: "Singh",
					email: "email@company.com",
					primary_email: "email@company.com",
					password: "$2b$10$L6NuTUSH9jdZ.6oJyY7bJeLWLF1dIf3K4crp00tBXETq6G0al6kP.",
					role: "super_admin",
					linkedin_url: null,
					primary_phone_number: "+33755523632",
					timezone: "Asia/Kolkata",
					language: "english",
					columns: null,
					smart_action_type: [],
					smart_action: false,
					is_profile_picture_present: true,
					ringover_user_id: "96337",
					salesforce_owner_id: "0052w00000BbsJyAAJ",
					integration_type: "salesforce_owner",
					integration_id: "0052w00000BbsJyAAJ",
					create_agendas_from_custom_task: false,
					calendly_url: "",
					is_call_iframe_fixed: true,
					settings_id: 11,
					is_onboarding_complete: true,
					created_at: "2022-12-22T06:46:42.000Z",
					updated_at: "2023-01-31T05:37:22.000Z",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					department_id: "a2a2d250-7941-459d-ac9c-edf16c696b39",
					sd_id: "40d9cbc2-0203-41e0-b086-414b5509d7cc",
					Company: {
						company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
						name: "Exploration Enterprise",
						url: null,
						linkedin_url: null,
						location: null,
						number_of_licences: 15,
						is_subscription_active: true,
						is_trial_active: false,
						integration_type: "salesforce",
						integration_id: "22824763",
						ringover_team_id: null,
						trial_valid_until: null,
						created_at: "2022-12-22T06:46:41.000Z",
						updated_at: "2023-01-02T10:46:44.000Z",
					},
				},
				LeadToCadences: [
					{
						status: "stopped",
						Cadences: [
							{
								cadence_id: 142,
								name: "Automatic_Reply_skip_test",
								salesforce_cadence_id: "a012w000012lQusAAE",
								status: "in_progress",
								unix_resume_at: null,
							},
						],
					},
				],
				Account: {
					account_id: 1,
					name: "Ringover",
					url: "test.com",
					linkedin_url: null,
					phone_number: "123456",
					size: "101-200",
					zipcode: null,
					country: " ",
					salesforce_account_id: null,
					integration_id: null,
					integration_type: "salesforce_account",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					integration_status: null,
					created_at: "2022-12-22T10:42:10.000Z",
					updated_at: "2023-01-31T12:24:31.000Z",
				},
				Lead_emails: [
					{
						lem_id: 1,
						email_id: "iamyu@gmi.com",
						is_primary: true,
						type: "Email",
						lead_id: 1,
						created_at: "2022-12-22T10:42:11.000Z",
						updated_at: "2023-01-25T10:22:26.000Z",
					},
				],
				Lead_phone_numbers: [
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 2,
						phone_number: "",
						type: "MobilePhone",
						timezone: null,
						is_primary: false,
						lead_id: 1,
						created_at: "2022-12-22T10:42:10.000Z",
						updated_at: "2022-12-22T10:42:10.000Z",
					},
					{
						formatted_phone_number: "",
						time: "",
						lpn_id: 1,
						phone_number: "",
						type: "Phone",
						timezone: null,
						is_primary: true,
						lead_id: 1,
						created_at: "2022-12-22T10:42:10.000Z",
						updated_at: "2022-12-22T10:42:10.000Z",
					},
				],
			},
			Email: {
				tracking_image_url:
					"https://cd-dev.ringover-crm.xyz/image/invisibleImage/18553988b0cf9c96",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				lead_id: 1,
				sent: false,
				et_id: null,
				message_id: "18553988b0cf9c96",
				thread_id: "1855398386f80c17",
				status: "delivered",
				tracking_status_update_timestamp: null,
				tracking_image_id: null,
				cadence_id: 74,
				node_id: 259,
				open_count: 0,
				unsubscribed: false,
				is_replied_mail: false,
				created_at: "2022-12-27T12:39:47.000Z",
				updated_at: "2022-12-28T11:43:15.000Z",
			},
		},
	],
	clicked_mails: [],
	received_sms: [],
	unsubscribed_mails: [],
	received_mails: [
		{
			activity_id: 38928,
			name: "Received email from Gyro Zeppeli",
			type: "mail",
			status:
				"Subject: Declined: Ringover meeting - Swarup Mondal @ Mon Jan 9, 2023 9am - 9:15am (IST) (email@company.com)",
			comment: null,
			recording: null,
			voicemail: null,
			to_number: null,
			from_number: null,
			incoming: true,
			read: true,
			ringover_call_id: null,
			salesforce_task_id: null,
			message_id: "1859741e0f250542",
			sent_message_id: null,
			gmail_message_id: null,
			note_id: null,
			cadence_id: null,
			node_id: null,
			task_id: null,
			created_at: "2023-01-09T15:59:14.000Z",
			updated_at: "2023-02-01T08:11:18.000Z",
			lead_id: 222,
			Lead: {
				lead_id: 222,
				type: "header_form",
				status: "ongoing",
				first_name: "Heraaaaass__",
				last_name: "karrrrrreeererse__",
				full_name: "Gyro Zeppeli",
				email: null,
				email_validity: null,
				linkedin_url: "linked.com",
				job_position: "Maharani",
				source_site: null,
				duplicate: null,
				first_path: null,
				salesforce: null,
				verified: false,
				score: null,
				first_contact_time: "2023-01-03T07:08:07.000Z",
				avg_time_till_first_call: 0,
				stopped_cadence: false,
				assigned_time: "2022-12-28T12:50:07.000Z",
				salesforce_lead_id: null,
				salesforce_contact_id: "0032w00000vHi8gAAC",
				integration_id: "0032w00000vHi8gAAC",
				integration_type: "salesforce_contact",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
				account_id: 47,
				ringover_message_conv_id: null,
				integration_status: null,
				created_at: "2022-12-28T12:50:07.000Z",
				updated_at: "2023-01-03T11:12:13.000Z",
				User: {
					profile_picture:
						"https://storage.googleapis.com/apt-cubist-307713.appspot.com/crm/profile-images/49ed6822-df47-4df9-ae2a-737e3a861f7a",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					first_name: "Yuvraj",
					last_name: "Singh",
					email: "email@company.com",
					primary_email: "email@company.com",
					password: "$2b$10$L6NuTUSH9jdZ.6oJyY7bJeLWLF1dIf3K4crp00tBXETq6G0al6kP.",
					role: "super_admin",
					linkedin_url: null,
					primary_phone_number: "+33755523632",
					timezone: "Asia/Kolkata",
					language: "english",
					columns: null,
					smart_action_type: [],
					smart_action: false,
					is_profile_picture_present: true,
					ringover_user_id: "96337",
					salesforce_owner_id: "0052w00000BbsJyAAJ",
					integration_type: "salesforce_owner",
					integration_id: "0052w00000BbsJyAAJ",
					create_agendas_from_custom_task: false,
					calendly_url: "",
					is_call_iframe_fixed: true,
					settings_id: 11,
					is_onboarding_complete: true,
					created_at: "2022-12-22T06:46:42.000Z",
					updated_at: "2023-01-31T05:37:22.000Z",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					department_id: "a2a2d250-7941-459d-ac9c-edf16c696b39",
					sd_id: "40d9cbc2-0203-41e0-b086-414b5509d7cc",
					Company: {
						company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
						name: "Exploration Enterprise",
						url: null,
						linkedin_url: null,
						location: null,
						number_of_licences: 15,
						is_subscription_active: true,
						is_trial_active: false,
						integration_type: "salesforce",
						integration_id: "22824763",
						ringover_team_id: null,
						trial_valid_until: null,
						created_at: "2022-12-22T06:46:41.000Z",
						updated_at: "2023-01-02T10:46:44.000Z",
					},
				},
				LeadToCadences: [
					{
						status: "completed",
						Cadences: [
							{
								cadence_id: 169,
								name: "Mail test",
								salesforce_cadence_id: "a012w000013Eik3AAC",
								status: "in_progress",
								unix_resume_at: null,
							},
						],
					},
				],
				Account: {
					account_id: 47,
					name: "newww2",
					url: "https://paytm.com",
					linkedin_url: null,
					phone_number: "425234234",
					size: "3",
					zipcode: 234234,
					country: "IN",
					salesforce_account_id: "0012w00001EgptNAAR",
					integration_id: "0012w00001EgptNAAR",
					integration_type: "salesforce_account",
					user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
					company_id: "f9411bdf-1d98-46bb-900e-e2ee78289f76",
					integration_status: null,
					created_at: "2022-12-28T12:50:07.000Z",
					updated_at: "2023-01-03T11:12:13.000Z",
				},
				Lead_emails: [
					{
						lem_id: 115,
						email_id: "swaranmon@gmail.com",
						is_primary: true,
						type: "Email",
						lead_id: 222,
						created_at: "2022-12-28T12:50:07.000Z",
						updated_at: "2022-12-29T11:42:27.000Z",
					},
				],
				Lead_phone_numbers: [
					{
						formatted_phone_number: "918927672100",
						time: "2:22:47 PM",
						lpn_id: 167,
						phone_number: "+91 89276 72100",
						type: "Phone",
						timezone: "Asia/Calcutta",
						is_primary: true,
						lead_id: 222,
						created_at: "2022-12-28T12:50:07.000Z",
						updated_at: "2022-12-29T11:42:27.000Z",
					},
				],
			},
			Email: {
				tracking_image_url:
					"https://cd-dev.ringover-crm.xyz/image/invisibleImage/1859741e0f250542",
				user_id: "49ed6822-df47-4df9-ae2a-737e3a861f7a",
				lead_id: 222,
				sent: false,
				et_id: null,
				message_id: "1859741e0f250542",
				thread_id: "1859741e0f250542",
				status: "delivered",
				tracking_status_update_timestamp: null,
				tracking_image_id: null,
				cadence_id: null,
				node_id: null,
				open_count: 0,
				unsubscribed: false,
				is_replied_mail: false,
				created_at: "2023-01-10T09:08:30.000Z",
				updated_at: "2023-01-10T09:08:30.000Z",
			},
		},
	],
	missed_calls: [],
};

const server = setupServer(
	rest.post(`${ENV.BACKEND}/v2/sales/home-page/live-feed`, async (req, res, ctx) => {
		const data = [];
		const { filter } = await req.json();
		if (filter.includes("all"))
			Object.keys(mails).forEach(value => {
				data.push(...mails[value]);
			});
		else
			filter.forEach(value => {
				data.push(...mails[value]);
			});
		return res(
			ctx.status(200),
			ctx.json({
				msg: "Activities found",
				data,
			})
		);
	})
);

beforeAll(() => server.listen());
afterEach(() => server.resetHandlers());
afterAll(() => server.close());

test("renders", async () => {
	render(<Feeds />);
	await screen.findByText(/Joseph Joestar has viewed the mail/i);
	await screen.findByText(/email sent to Jolyne Cujoh has bounced/i);
	await screen.findByText(/received email from Gyro Zeppeli/i);
	await screen.findByText(/reply received from Enrico Pucci/i);
});

test("filters", async () => {
	const user = userEvent.setup();
	render(<Feeds />);

	await user.click(
		screen.getByRole("button", {
			name: /all filters/i,
		})
	);
	await screen.findByText(/replied mails/i);
	await user.click(screen.getByText(/replied mails/i));

	await screen.findByText(/reply received from Enrico Pucci/i);
	try {
		await screen.findByText(/Joseph Joestar has viewed the mail/i);
		await screen.findByText(/email sent to Jolyne Cujoh has bounced/i);
		await screen.findByText(/received email from Gyro Zeppeli/i);
	} catch (e) {
		expect(e).toEqual(expect.anything());
	}

	await user.click(screen.getByText(/bounced mails/i));

	await screen.findByText(/reply received from Enrico Pucci/i);
	await screen.findByText(/email sent to Jolyne Cujoh has bounced/i);
	try {
		await screen.findByText(/Joseph Joestar has viewed the mail/i);
		await screen.findByText(/received email from Gyro Zeppeli/i);
	} catch (e) {
		expect(e).toEqual(expect.anything());
	}

	await user.click(
		screen.getByRole("button", {
			name: /clear/i,
		})
	);

	await screen.findByText(/Joseph Joestar has viewed the mail/i);
	await screen.findByText(/email sent to Jolyne Cujoh has bounced/i);
	await screen.findByText(/received email from Gyro Zeppeli/i);
	await screen.findByText(/reply received from Enrico Pucci/i);
});
